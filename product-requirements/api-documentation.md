# Register Surplus Forms API Documentation

## POST /api/v1/registrations

### Description
Stores a completed registration form and returns ID and reference number

### Endpoint
```
POST /api/v1/registrations
```

### Headers
```
Content-Type: application/json
```

### Body Schema
```json
{
  "type": "object",
  "required": [
    "formType",
    "penColourNotUsed",
    "guidanceRead"
  ],
  "properties": {
    "formType": {
      "type": "string",
      "enum": ["AD01", "B07", "K432", "D243", "OTHER"]
    },
    "formTypeOtherText": {
      "type": "string"
    },
    "penColourNotUsed": {
      "type": "string",
      "enum": ["BLUE", "BLACK", "RED", "GREEN", "OTHER"]
    },
    "guidanceRead": {
      "type": "string",
      "enum": ["YES", "LOOKED_AT_NOW", "NO"]
    }
  },
  "additionalProperties": false
}
```

### Example Request
```json
{
  "formType": "AD01",
  "penColourNotUsed": "BLUE",
  "guidanceRead": "YES"
}
```

### Example Request with OTHER form type
```json
{
  "formType": "OTHER",
  "formTypeOtherText": "Custom form type",
  "penColourNotUsed": "RED",
  "guidanceRead": "LOOKED_AT_NOW"
}
```

### Responses

#### 201 Created
Successfully created registration

```json
{
  "id": "2b3c55b8-a480-4f2e-bf0d-8d3f9e2bf4be",
  "referenceNumber": "HDJ2123F"
}
```

#### 422 Unprocessable Entity
Validation error

```json
{
  "status": "error",
  "message": "Validation failed",
  "errors": [
    {
      "field": "formType",
      "message": "must be equal to one of the allowed values"
    }
  ]
}
```

#### 503 Service Unavailable
Server or database error

```json
{
  "status": "error",
  "message": "Service unavailable"
}
```

### Validation Rules
- `formType` must be one of: "AD01", "B07", "K432", "D243", "OTHER"
- If `formType` is "OTHER", then `formTypeOtherText` is required and must not be empty
- `penColourNotUsed` must be one of: "BLUE", "BLACK", "RED", "GREEN", "OTHER"
- `guidanceRead` must be one of: "YES", "LOOKED_AT_NOW", "NO"
- No additional properties are allowed

## GET /api/v1/registrations/:id

### Description
Retrieves a specific registration by its UUID

### Endpoint
```
GET /api/v1/registrations/:id
```

### Parameters
- `id` (path parameter): UUID of the registration to retrieve

### Example
```
GET /api/v1/registrations/2b3c55b8-a480-4f2e-bf0d-8d3f9e2bf4be
```

### Responses

#### 200 OK
Successfully retrieved registration

```json
{
  "id": "2b3c55b8-a480-4f2e-bf0d-8d3f9e2bf4be",
  "referenceNumber": "HDJ2123F",
  "formType": "AD01",
  "formTypeOtherText": null,
  "penColourNotUsed": "BLUE",
  "guidanceRead": "YES"
}
```

#### 404 Not Found
Registration not found

```json
{
  "status": "error",
  "message": "Not Found"
}
```

#### 503 Service Unavailable
Server or database error

```json
{
  "status": "error",
  "message": "Service unavailable"
}
```

## Data Model

| Field               | Type                                   | Notes                                                                                  |
| ------------------- | -------------------------------------- | -------------------------------------------------------------------------------------- |
| `id`                | `uuid` **PK**                          | `uuidv4` created by API, returned to frontend                                          |
| `referenceNumber`   | `char(8)`                              | Format `/^[A-Z0-9]{8}$/`, e.g. **HDJ2123F** â€“ generated by API for confirmation screen |
| `formType`          | `string`                               | enum: `AD01`, `B07`, `K432`, `D243`, `OTHER`                                           |
| `formTypeOtherText` | `string nullable`                      | only sent when `formType === "OTHER"`                                                  |
| `penColourNotUsed`  | `string`                               | enum: `BLUE`, `BLACK`, `RED`, `GREEN`, `OTHER`                                         |
| `guidanceRead`      | `string`                               | enum: `YES`, `LOOKED_AT_NOW`, `NO`                                                     |
| `createdAt`         | `datetime` default `CURRENT_TIMESTAMP` | audit only                                                                             | 